---

- name: SAP Install Media Detect - SAPCAR - Get SAPCAR executable file from folder - {{ __sap_install_media_detect_software_main_directory }}
  ansible.builtin.shell: ls SAPCAR*.EXE
  args:
    chdir: "{{ sap_install_media_detect_source_directory }}"
  register: sap_swpm_sapcar_file_name_get
  changed_when: false

- name: SAP Install Media Detect - SAPCAR - Set fact
  ansible.builtin.set_fact:
    sap_swpm_sapcar_file_name: "{{ sap_swpm_sapcar_file_name_get.stdout }}"

- name: SAP Install Media Detect - SAPCAR - Copy SAPCAR file to {{ sap_install_media_detect_target_directory }}
  ansible.builtin.copy:
    src: "{{ sap_install_media_detect_source_directory }}/{{ sap_swpm_sapcar_file_name }}"
    dest: "{{ sap_install_media_detect_target_directory }}/{{ sap_swpm_sapcar_file_name | basename }}"
    remote_src: true
  when: sap_install_media_detect_source == 'remote_dir'

- name: SAP Install Media Detect - SAPCAR - Change ownership of SAPCAR
  ansible.builtin.file:
    path: "{{ __sap_install_media_detect_software_main_directory }}/{{ sap_swpm_sapcar_file_name }}"
    state: file
    mode: '0755'
    owner: root
    group: root
